<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <title>User Manage Page</title>
    <link href="http://unpkg.com/view-design/dist/styles/iview.css" rel="stylesheet" type="text/css">
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <script src="http://unpkg.com/view-design/dist/iview.min.js" type="text/javascript"></script>
</head>

<body>
<div id="app">
    <div class="layout" style="width: 960px; margin: 0 auto;">
        <Layout>
            <header>
                <row>
                    <Divider orientation="left">
                        <h1>初级中学管理系统</h1>
                    </Divider>
                </row>

                <row justify="start" type="flex">
                    <i-col style="margin-right: 10px" v-for="(item, index) in menu">
                        <span v-if="item.reply === 'frontSearch'">
                            <input name="search" placeholder="item.label" v-model="searchKey">
                        </span>
                        <i-button :icon="item.icon" :type="item.type" @click="OperateMenu(index, item.reply)" v-show="item.show">{{item.label}}</i-button>
                    </i-col>
                </row>
            </header>





            <div>
                <i-table :border="showBorder" :columns="tableColumns1" :data="data2" :height="fixedHeader ? 250 : ''" :showHeader="showHeader" :size="tableSize" :stripe="showStripe">
                    <template slot="name" slot-scope="{ row }">
                        <strong>{{ row.name }}</strong>
                    </template>
                    <template slot="action" slot-scope="{ row, index }">
                        <i-button @click="show(index)" icon="ios-create-outline" size="small" style="margin-right: 5px" type="primary">编辑</i-button>
                        <i-button @click="remove(index)" icon="ios-trash" size="small" type="error">删除</i-button>
                    </template>
                </i-table>

                <div style="margin: 10px;overflow: hidden">
                    <div style="float: right;">
                        <Page :current="currentPage" :pageSize="pageSize" :total="data1.length" @on-change="changePage" @on-page-size-change="changePageSize" show-elevator show-sizer show-total></Page>
                    </div>
                </div>
            </div>
        </Layout>

        <Drawer :closable="true" :mask="false" title="Set up" v-model="setUp">
            <div style="margin: 10px">
                Table Setting<br>
                <i-switch style="margin-right: 5px" v-model="showBorder"></i-switch>Display border<br>
                <i-switch style="margin-right: 5px" v-model="showStripe"></i-switch>Display stripe<br>
                <i-switch style="margin-right: 5px" v-model="showIndex"></i-switch>Display index<br>
                <i-switch style="margin-right: 5px" v-model="showCheckbox"></i-switch>Display multi choice<br>
                <i-switch style="margin-right: 5px" v-model="showHeader"></i-switch>Display header<br>
                <i-switch style="margin-right: 5px" v-model="fixedHeader"></i-switch>Display scrolling<br>
                <br><br>

                Table size
                <i-select style="width: 200px" v-model="tableSize">
                    <i-option value="large">large</i-option>
                    <i-option value="default">default</i-option>
                    <i-option value="small">small</i-option>
                </i-select>
            </div>
        </Drawer>

        <Modal @on-cancel="cancelEditor" @on-ok="okEditor" title="请输入登录信息" v-model="logModal">
            <i-form :label-width="80">
                <form-item :label="item.name" v-for="item in logFrameData">
                    <div v-if="item.quaker == 'text'">
                        <i-input :placeholder="item.name" maxlength="30" style="width: 260px;" type="text" v-model="item.backData"/>
                    </div>
                    <div v-else-if="item.quaker == 'password'">
                        <i-input :placeholder="item.name" maxlength="60" style="width: 260px;" type="password" v-model="item.backData"/>
                    </div>
                </form-item>
            </i-form>
        </Modal>
        <Modal @on-cancel="cancelEditor" @on-ok="okEditor" title="请填写注册信息" v-model="regModal">
            <i-form :label-width="80">
                <form-item :label="item.name" v-for="item in regFrameData">
                    <div v-if="item.quaker == 'text'">
                        <i-input :placeholder="item.name" maxlength="30" style="width: 260px;" type="text" v-model="item.backData"/>
                    </div>
                    <div v-else-if="item.quaker == 'password'">
                        <i-input :placeholder="item.name" maxlength="60" style="width: 260px;" type="password" v-model="item.backData"/>
                    </div>
                    <div v-else-if="item.quaker == 'radio'">
                        <input :id="kindergarden.name" name="gender" style="width: 80px;" type="radio" v-for="kindergarden in item.frontData" v-model="item.backData">
                            {{kindergarden.name}}
                        </input>
                    </div>
                    <div v-else-if="item.quaker == 'checkbox'">
                        <CheckGroup v-model="item.backData">
                            <i-checkbox :label="chk.name" style="width: 160px" v-for="chk in item.frontData" v-model="item.backData">
                                {{chk.name}}
                            </i-checkbox>
                        </CheckGroup>
                    </div>
                    <div v-else-if="item.quaker == 'select'">
                        <i-select style="width: 260px;" v-model="item.backData">
                            <i-option :value="sel.name" v-for="sel in item.frontData">{{sel.name}}</i-option>
                        </i-select>
                    </div>
                    <div v-else-if="item.quaker == 'textarea'">
                        <i-input :placeholder="item.name" style="width: 260px;" type="text" v-model="item.backData"/>
                    </div>
                    <div v-else>
                        <i-input :placeholder="item.name" style="width: 260px;" type="textarea" v-model="item.backData"/>
                    </div>

                </form-item>
            </i-form>

        </Modal>
    </div>

</div>


<script>
    let app = new Vue({
        el: '#app',
        data() {
            return {
                logOrReg:false,
                logModal:false,
                regModal:false,
                empInfo:{
                    uid:'',
                    name:'',
                    email:'',
                    deptName:''
                },
                setUp:false,
                currentPage:1,
                pageSize:10,
                tableColumns1: [{
                    type: 'index2',
                    width: 80,
                    align: 'center',
                    //well, please change the setting of language from  ECMA 5.1 to  ECMA 6.0
                    render: (h, params) => {
                        return h('span',params.index + (this.currentPage - 1) * this.pageSize + 1);
                    }
                },
                    {
                        title: '学号',
                        key: 'uid',
                        sortable:true
                    },
                    {
                        title: 'Name',
                        slot: 'name'
                    },
                    {
                        title: '邮箱',
                        key: 'email',
                        sortable: true
                    },
                    {
                        title: '年级',
                        key: 'deptName'
                    },
                    {
                        title: 'Action',
                        slot: 'action',
                        width: 200,
                        align: 'center'
                    }
                ],
                dept: [{
                    deptId: '1',
                    deptName: '初一级部'
                },{
                    deptId: '2',
                    deptName: '初二级部'
                },{
                    deptId: '3',
                    deptName: '初三级部'
                }],

                data1:[{
                        uid: '1001',
                        name: 'Nagisa',
                        email: 'Nagisa@Tkoyo.com',
                        deptId: '1',
                        deptName: '初一级部'
                    },
                    {
                        uid: '1002',
                        name: 'Madoka',
                        email: 'Madoka@Xuold.per',
                        deptId: '2',
                        deptName: '初一级部'
                    },
                    {
                        uid: '1003',
                        name: 'Pain',
                        email: 'PainSix@naruto.mov',
                        deptId: '3',
                        deptName: '初三级部'
                    },
                    {
                        uid: '1004',
                        name: 'Yuki',
                        email: 'Yuki@depress.mkv',
                        deptId: '2',
                        deptName: '初二级部'
                    }],


                titleModel: '仅供测试',
                searchKey: '搜索',
                extModLaEa:true,
                extModLaEb:true,
                regFrameData: [{
                    name:'用户名',
                    quaker:'text',
                    frontData:[],
                    backData:'',
                    flag:0
                },{
                    name:'密码',
                    quaker:'password',
                    frontData:[],
                    backData:'',
                    flag:0
                },{
                    name:'重复密码',
                    quaker:'password',
                    frontData:[],
                    backData:'',
                    flag:0
                },{
                    name:'姓名',
                    quaker:'text',
                    frontData:[],
                    backData:'',
                    flag:0
                },{
                    name:'性别',
                    quaker:'radio',
                    frontData:[
                        {name:'男',value:0},
                        {name:'女',value:1}],
                    backData:0,
                    flag:0
                },{
                    name:'身份证号',
                    quaker:'text',
                    frontData:[],
                    backData:'',
                    flag:0
                },{
                    name:'手机号',
                    quaker:'text',
                    frontData:[],
                    backData:111,
                    flag:0
                },{
                    name:'所在班级',
                    quaker:'select',
                    frontData:[{
                        index:1,
                        name:'初一级部'
                    },{
                        index:2,
                        name:'初二级部'
                    },{
                        index:3,
                        name:'初三级部'
                    }],
                    backData:1,
                    flag:0
                }],

                logFrameData: [{
                    name:'用户名',
                    quaker:'text',
                    backData:'',
                    flag:0
                },{
                    name:'密码',
                    quaker:'password',
                    backData:'',
                    flag:0
                },{
                    name:'验证码',
                    quaker:'text',
                    backData:'',
                    flag:0
                }],

                data2:[],
                showBorder:false,
                showStripe:false,
                showHeader:true,
                showIndex:true,
                showCheckbox:false,
                fixedHeader:false,
                tableSize: 'default',

                menu: [{
                    label: '首页',
                    icon:'md-home',
                    type:'primary',
                    show:true,
                    reply:'frontHome',
                    link: '#'
                },{
                    label: '校园风采',
                    icon:'md-school',
                    type:'info',
                    show:true,
                    reply:'frontEcology',
                    link: '#'
                },{
                    label: '相关数据',
                    icon:'ios-paper',
                    type:'info',
                    show:true,
                    reply:'frontData',
                    link: '#'
                },{
                    label: '设备维护',
                    icon:'ios-construct',
                    type:'info',
                    show:true,
                    reply:'frontRepair',
                    link: '#'
                },{
                    label: '注册',
                    icon:'md-add-circle',
                    type:'info',
                    show:true,
                    reply:'frontRegister',
                    link: '#'
                },{
                    label: '登录',
                    icon:'md-log-in',
                    type:'info',
                    show:true,
                    reply:'frontLog',
                    link: '#'
                },{
                    label: '搜索',
                    icon:'md-search',
                    type:'primary',
                    show:true,
                    reply:'frontSearch',
                    link: '#'
                },
                ]
            }
        },
        methods: {
            OperateMenu(index, reply) {
                console.log('menu ' + index + ', trigger ' + reply);
                if (reply == 'frontHome'){
                    this.frontHome();
                }else if (reply == 'frontEcology') {
                    this.frontEcology();
                }else if (reply == 'frontData') {
                    this.frontData();
                }else if (reply == 'frontRepair') {
                    this.frontRepair();
                }else if (reply == 'frontRegister') {
                    this.frontRegister();
                }else if (reply == 'frontLog') {
                    this.frontLog();
                }else if (reply == 'frontSearch') {
                    this.frontSearch();
                }else {
                    console.log(" error ......")
                }
            },
            changePage(index) {
                console.log(' the index=' + index);
                this.currentPage = index;
                this.data2 = [].concat(this.data1.slice((index - 1) * this.pageSize, index * this.pageSize));
            },
            show(index) {
                this.empInfo = Object.assign(this.empInfo, this.data2[index]);
                this.logOrReg=true;
                this.empInfo = Object.assign(this.empInfo, {index: index});
            },
            frontHome() {
                console.log(" well the home page coming ");
            },
            frontEcology() {
                console.log(" well life-style in campus");
            },
            frontData() {
                console.log(" well all history data can be visited here");
            },
            frontRepair() {
                console.log(" well for the state of equipments");
            },
            frontSearch() {
                console.log(" well the search key is " + this.searchKey);
            },
            frontLog() {
                this.empInfo=[];
                this.logModal=true;
                this.regModal=false;
                this.logOrReg=true;
                console.log("well, I am logging in")
            },
            frontRegister() {
                this.empInfo=[];
                this.logModal=false;
                this.regModal=true;
                this.logOrReg=false;
                console.log("well, I am register")
            },

            frontExOne() {
                console.log(" well all history data can be visited here");
            },
            frontExTwo() {
                console.log(" well for the state of equipments");
            },

            remove(index) {
                this.data1.splice((this.currentPage - 1) * 10 + index, 1)
            },
            changePageSize(index) {
                this.$Message.info({
                    content: '当前页面显示条数修改为： ' + index + '条/页'
                });
                this.currentPage=1;
                this.pageSize=index;
                this.changePage(this.currentPage);
            },
            okEditor() {
                if (this.logOrReg) {
                    this.data1.splice((this.currentPage - 1) * 10 + this.empInfo.index, 1, this.empInfo)
                } else {
                    this.data1.push(Object.assign({}, this.empInfo))
                }
                this.empInfo = {}
            },
            cancelEditor() {
                this.$Message.info({
                    content: '操作取消'
                })
            }
        },

        watch: {
            showIndex(newVal) {
                if (newVal) {
                    this.tableColumns1.unshift({
                        type: 'index2',
                        width: 80,
                        align: 'center',
                        render: (h, params) => {
                            return h('span', params.index + (this.currentPage - 1) * this.pageSize + 1);
                        }
                    })
                } else {
                    this.tableColumns1.forEach((item, index) => {
                        if (item.type === 'index2') {
                            this.tableColumns1.splice(index, 1)
                        }
                    })
                }
            },
            showCheckbox(newVal) {
              if (newVal) {
                  this.tableColumns1.unshift({
                      type: 'selection',
                      width: 60,
                      align: 'center'
                  })
              }   else {
                  this.tableColumns1.forEach((item, index) => {
                      if (item.type === 'selection') {
                          this.tableColumns1.splice(index, 1)
                      }
                  })
              }
            },
            data1() {
                if (!this.logOrReg) {
                    this.changePage(Math.ceil(this.data1.length / this.pageSize))
                } else {
                    this.changePage(this.currentPage)
                }
            }
        },
        mounted() {
            this.changePage(this.currentPage)
        }
    })
</script>
</body>
</html>